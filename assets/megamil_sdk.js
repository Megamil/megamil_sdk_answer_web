document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector('script[data-sdk="megamil"]');var t=!0,n="demo2865406.mockable.io/";let a=e.getAttribute("data-sdk-token"),o=e.getAttribute("data-placeholder")||"Me pergunte qualquer coisa",r=e.getAttribute("data-error-message-default")||"Desculpe, tivemos um problema, por favor tente novamente.",l=e.getAttribute("data-unicode-icon-send")||"&#x1F680;",i=e.getAttribute("data-unicode-icon-open")||"&#x1F680;",d=e.getAttribute("data-unicode-icon-close")||"&#x58;",s=e.getAttribute("data-ia-name")||"",c=e.getAttribute("data-chat-color")||"#F0F0F0",u=e.getAttribute("data-from-me-color")||"#248bf5",m=e.getAttribute("data-from-them-color")||"#e5e5ea",p=e.getAttribute("data-from-me-text-color")||"#FFFFFF",g=e.getAttribute("data-from-them-text-color")||"#000000";var h=[];let f=function e(){let t=document.createElement("div");return t.classList.add("modal"),t}(),b=function e(){let t=document.createElement("input");return t.type="text",t.placeholder=o,t.classList.add("chat-input"),t.style.zIndex="9999",t}(),$=function e(){let t=document.createElement("button");return t.innerHTML=l,t.classList.add("send-message-button"),t.style.backgroundColor=u,t}(),y=function e(){let t=document.createElement("div");return t.classList.add("messagebox"),t}(),C=function e(){let t=document.createElement("div"),n=document.createElement("a");return n.href="https://www.megamil.com.br",n.target="_blank",n.textContent="Megamil 2023",t.appendChild(n),t.classList.add("credits"),t}(),L=!1;E(!1),fetch(x("api/valid?version=0.0.1"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a}}).then(e=>e.json()).then(e=>{e&&e.versionEnable&&e.payment?(t=e.isSecurity,n=e.server,E(!0)):k(r,!1)}).catch(e=>console.error(e)),document.body.appendChild(function e(){let t=document.createElement("div");return t.classList.add("float-chat-button"),t.innerHTML=l,t}()),document.body.appendChild(f);let v=document.querySelector(".float-chat-button");function E(e){b.value=e?"":"...",b.disabled=!e}function x(e){let a=t?"https://":"http://";return a+n+e}function _(e){let t=document.createElement("div");t.classList.add("time-line");let n=document.createElement("span");n.classList.add("time-label");let a=new Date,o=10>a.getDate()?"0"+a.getDate():a.getDate(),r=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,l=a.getFullYear(),i=10>a.getHours()?"0"+a.getHours():a.getHours(),d=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes();n.textContent=`${o}/${r}/${l} ${i}:${d}
`,t.appendChild(n),e.prepend(t)}function k(e,t){if(e){let n=document.createElement("p");n.classList.add("from-them"),n.classList.add("no-tail"),n.classList.add(t?"warning":"danger"),n.style.backgroundColor=m,n.style.color=g,n.textContent=e,_(n),y.prepend(n),y.scrollTop=0}}v.innerHTML=i,v.style.backgroundColor=c,document.querySelector(".modal").style.backgroundColor=c,v.addEventListener("click",function(){L=!L,f.classList.toggle("modal-open"),v.innerHTML=L?d:i}),f.appendChild(b),f.appendChild($),f.appendChild(y),f.appendChild(C),$.addEventListener("click",function e(){let t=b.value.trim();if(t){let n=document.createElement("p");n.classList.add("from-me"),n.textContent=t,n.style.backgroundColor=u,n.style.color=p;let a=`
          border-right: 1rem solid ${u};
          `,o=document.createElement("style");o.textContent=`p.from-me:before { ${a} }`,document.head.appendChild(o),_(n),y.prepend(n),y.scrollTop=0,function e(){h.add({name:"user",message:b.text}),console.log(h);let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)};E(!1),fetch(x("api/ai"),t).then(e=>e.json()).then(e=>{if(e&&e.choices&&e.choices[0]&&e.choices[0].text){let t=e.choices[0].text;h.add({name:"IA",message:t}),E(!0),function e(t){if(t){let n=document.createElement("p");n.classList.add("from-them"),n.textContent=s+t,n.style.backgroundColor=m,n.style.color=g;let a=`
          border-left: 1rem solid ${m};
          `,o=document.createElement("style");o.textContent=`p.from-them:before { ${a} }`,document.head.appendChild(o),_(n),y.prepend(n),y.scrollTop=0}}(t)}else k(r,!1)}).catch(e=>console.error(e))}()}}),b.addEventListener("keyup",function(e){"Enter"===e.key&&(e.preventDefault(),$.click())})});